(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[303],{72431:function(){},42499:function(e,t,n){Promise.resolve().then(n.bind(n,44946))},44946:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return M}});var l=n(57437),a=n(84653),r=n(41469),i=n(57818),o=n(16463),s=n(77641),c=n(2265),d=n(97437),u=n(64029),h=n(97333),m=n(60502),p=n(51755),x=n(18058),_=n(73208);let j=e=>{let[t,n]=(0,c.useState)([]),l=(0,d.v9)(e=>e.auth);return(0,c.useEffect)(()=>{e&&Promise.all(e.map(e=>_.Z.get("http://localhost:8010/api/region/".concat(e.id,"/"),{headers:{Authorization:"Token ".concat(l.token)}}))).then(e=>{n(e.map(e=>{let t=e.data;return t.geometry.properties.name=e.data.name,t}))}).catch(e=>{console.log(e)})},[e]),t};var y=n(6148),g=n(54277),f=n(70741),v=n(35126),S=n(47559),b=n(15330),I=n(66252),w=n(59801),Z=e=>{let{percentiles:t,reductionStartYear:n,reductionCompleteYear:r}=e,[i,o]=(0,y.c)(t),[s,d]=(0,c.useState)([5,50,95]),[u,m]=(0,c.useState)("Select 5th, 50th, 95th");function p(e){let t=[];return e.forEach(e=>{var n;let l=[];null===(n=i[e])||void 0===n||n.forEach(e=>{l.push({x:e.year,y:e.value})}),t.push({name:"".concat(e,"th percentile"),data:l})}),t}let[x,_]=(0,c.useState)(p(s));return((0,c.useEffect)(()=>{_(p(s))},[i,s]),i)?(0,l.jsxs)("div",{children:[(0,l.jsx)(I.default,{showSearch:!0,placeholder:"Select Percentiles",optionFilterProp:"children",mode:"multiple",allowClear:!0,value:s,onChange:d,style:{width:"100%"},children:o.map(e=>(0,l.jsxs)(I.default.Option,{value:e,children:[e,"th percentile"]},e))}),(0,l.jsxs)(h.B,{style:{marginTop:20,marginBottom:40},children:[(0,l.jsxs)(h.B,{spacing:"small",children:[(0,l.jsx)(a.ZP,{type:"Select 5th, 50th, 95th"===u?"primary":"default",onClick:()=>{d([5,50,95]),m("Select 5th, 50th, 95th")},children:"Select 5th, 50th, 95th"}),(0,l.jsx)(a.ZP,{type:"Select 10th, 50th, 90th"===u?"primary":"default",onClick:()=>{d([10,50,90]),m("Select 10th, 50th, 90th")},children:"Select 10th, 50th, 90th"}),(0,l.jsx)(a.ZP,{type:"Select 25th, 50th, 75th"===u?"primary":"default",onClick:()=>{d([25,50,75]),m("Select 25th, 50th, 75th")},children:"Select 25th, 50th, 75th"})]}),(0,l.jsx)(a.ZP,{type:"Select All"===u?"primary":"default",onClick:()=>{d(o),m("Select All")},children:"Select All"})]}),(0,l.jsx)(w.Z,{data:x,reductionEndYear:r,reductionStartYear:n})]}):(0,l.jsx)("div",{})},C=n(41880),E=n(1633),F=e=>{var t;let{modelDetail:n,regions:a}=e;return(0,l.jsxs)(C.Z,{bordered:!0,column:{xxl:4,xl:3,lg:3,md:2,sm:1,xs:1},children:[(0,l.jsx)(C.Z.Item,{label:"Scenario name",children:null==n?void 0:n.name}),(0,l.jsx)(C.Z.Item,{label:"Date created",children:(null==n?void 0:n.date_submitted)?new Date(n.date_submitted).toLocaleString():""}),(0,l.jsx)(C.Z.Item,{label:"Date completed",children:(null==n?void 0:n.date_completed)?new Date(n.date_completed).toLocaleString():"not yet completed"}),(0,l.jsx)(C.Z.Item,{label:"Stimulation end year",children:null==n?void 0:n.sim_end_year}),(0,l.jsx)(C.Z.Item,{label:"Implementation start year",children:null==n?void 0:n.reduction_start_year}),(0,l.jsx)(C.Z.Item,{label:"Implementation complete year",children:null==n?void 0:n.reduction_end_year}),(0,l.jsx)(C.Z.Item,{label:"Flow Scenario",children:(null==n?void 0:n.flow_scenario)&&n.flow_scenario.name||""}),(0,l.jsx)(C.Z.Item,{label:"Load Scenario",children:(null==n?void 0:n.load_scenario)&&n.load_scenario.name||""}),(0,l.jsx)(C.Z.Item,{label:"Well Type Scenario",children:(null==n?void 0:n.welltype_scenario)&&(null==n?void 0:n.welltype_scenario.name)||""}),(0,l.jsx)(C.Z.Item,{label:"Unsat Scenario",children:(null==n?void 0:n.unsat_scenario)&&(null==n?void 0:n.unsat_scenario.name)||""}),(0,l.jsx)(C.Z.Item,{label:"Water content",children:n?"".concat(((null!==(t=null==n?void 0:n.water_content)&&void 0!==t?t:0)*100).toFixed(0),"%"):""}),(0,l.jsx)(C.Z.Item,{label:"Number of wells detected in selected region(s)",children:(null==n?void 0:n.n_wells)||"scenario run not yet complete"}),(0,l.jsx)(C.Z.Item,{label:"Scenario description",span:3,children:(null==n?void 0:n.description)||"no description"}),(0,l.jsx)(C.Z.Item,{label:"Region(s)",span:3,children:a.map(e=>e.name).join(", ")||""}),(null==n?void 0:n.applied_simulation_filter)?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(C.Z.Item,{label:"Depth range",span:1.5,children:"".concat(null==n?void 0:n.depth_range_min," ~ ").concat((null==n?void 0:n.depth_range_max)===E.yb.max+1?"max":null==n?void 0:n.depth_range_max)}),(0,l.jsx)(C.Z.Item,{label:"Screen length range",span:1.5,children:"".concat(null==n?void 0:n.screen_length_range_min," ~ ").concat((null==n?void 0:n.screen_length_range_max)===E.m7.max+1?"max":null==n?void 0:n.screen_length_range_max)})]}):null]})},P=n(73454),k=n(77733),L=n(95381),N=n(14178);let D={chart:{height:200,type:"heatmap"},colors:["#5A9BD5"],plotOptions:{heatmap:{shadeIntensity:1}},dataLabels:{enabled:!1},tooltip:{custom(e){let{series:t,seriesIndex:n,dataPointIndex:l,w:a}=e;return""!==a.globals.seriesNames[n]?t[n][l]:""}}},Y=(0,i.default)(()=>Promise.all([n.e(562),n.e(865)]).then(n.bind(n,63865)),{loadableGenerated:{webpack:()=>[63865]},ssr:!1});var A=e=>{let{data:t}=e;return(0,l.jsx)(Y,{options:D,series:t,type:"heatmap",width:"100%",height:500})},B=e=>{let{baseResults:t,customResults:n,percentiles:r}=e,[i,o]=(0,c.useState)({}),[s,d]=(0,c.useState)(18.5);return(0,c.useEffect)(()=>{if(t&&n){let e={};r.forEach(l=>{var a,r;let i=[],o=null!==(a=t[l])&&void 0!==a?a:[],s=null!==(r=n[l])&&void 0!==r?r:[],c=Math.min(o.length,s.length);for(let e=0;e<c;e+=1)i.push({year:o[e].year,percentile:o[e].percentile,value:Number((o[e].value-s[e].value).toFixed(6))});Object.assign(e,{["".concat(l)]:i})}),o(e)}},[t,n]),(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(P.Z,{onFinish:e=>{d(e.years)},children:(0,l.jsxs)(k.Z,{gutter:24,children:[(0,l.jsx)(L.Z,{span:8,children:(0,l.jsx)(P.Z.Item,{required:!0,rules:[{validator:(e,t)=>t<=200&&t>=5?Promise.resolve():Promise.reject(Error("Out of range. Select from 5 to 200"))}],label:(0,l.jsx)("span",{children:"Aggregate(avg) years "}),name:"years",initialValue:s,children:(0,l.jsx)(N.Z,{style:{width:"100%"},max:200,min:5})})}),(0,l.jsx)(L.Z,{span:2,children:(0,l.jsx)(P.Z.Item,{style:{float:"right"},children:(0,l.jsx)(a.ZP,{htmlType:"submit",type:"primary",children:"Submit"})})})]})}),(0,l.jsx)(A,{data:((e,t)=>{let n=[];return t&&e&&r.forEach(l=>{let a=e[l];if(!a)return;let r=a.length,i=[];for(let e=0;e<r;e+=t){let n=a.slice(e,Math.min(e+t,r)),l=0,o="";n.forEach(e=>{var t;l+=null!==(t=e.value)&&void 0!==t?t:0}),e+t>r?(o="".concat(1945+e," - ").concat(1945+r),l=Number((l/(r-e)).toFixed(2))):(o="".concat(1945+e," - ").concat(1945+e+t),l=Number((l/t).toFixed(2))),i.push({x:o,y:l})}n.push({name:"".concat(l,"th percentile"),data:i})}),n})(i,s)})]})},M=()=>{var e,t,_,I,w;let C=(0,o.useSearchParams)(),E=(0,f.qF)(parseInt(C.get("id"),10)),P=(0,d.I0)(),[k,L]=(0,c.useState)("1"),N=(0,i.default)(()=>Promise.all([n.e(212),n.e(37)]).then(n.bind(n,54037)),{loadableGenerated:{webpack:()=>[54037]},ssr:!1}),D=(null!==(e=E.data)&&void 0!==e?e:[null,null])[0],Y=(null!==(t=E.data)&&void 0!==t?t:[null,null])[1],[A,M]=(0,y.c)(null!==(_=null==D?void 0:D.results)&&void 0!==_?_:[]),[R]=(0,y.c)(null!==(I=null==Y?void 0:Y.results)&&void 0!==I?I:[]),O=j(null!==(w=null==D?void 0:D.regions)&&void 0!==w?w:[]),T={name:"base",plotData:R},U={name:"custom",plotData:A};(0,g.c)();let W=(0,c.useMemo)(()=>(0,l.jsx)(l.Fragment,{children:!E.isFetching&&!E.error&&D&&!E.error&&(0,l.jsx)(S.Z,{comparisonChartModels:[T,U],percentiles:M,reductionStartYear:D.reduction_start_year,reductionCompleteYear:D.reduction_end_year})}),[T,U,M,D]),V=(0,c.useMemo)(()=>(0,l.jsx)(l.Fragment,{children:!E.isFetching&&!E.error&&D&&!E.error&&(0,l.jsx)(B,{baseResults:R,customResults:A,percentiles:M})}),[R,A,M]);return E.isFetching||E.error||!D?(0,l.jsx)("div",{}):(E.error&&console.log(E.error),(0,l.jsxs)(u.Z,{children:[(0,l.jsxs)(h.B,{children:[(0,l.jsx)(p.n,{variant:"h1",children:"Details and Results"}),(0,l.jsx)(a.ZP,{type:"primary",size:"large",onClick:()=>{D&&(P((0,v._y)({name:D.name,description:D.description,water_content:D.water_content,sim_end_year:D.sim_end_year,reduction_start_year:D.reduction_start_year,reduction_end_year:D.reduction_end_year,flow_scenario:D.flow_scenario,load_scenario:D.load_scenario,unsat_scenario:D.unsat_scenario,welltype_scenario:D.welltype_scenario,regions:D.regions,modifications:D.modifications,public:!0,is_base:!1,applied_simulation_filter:!1})),s.default.push("/model/create"))},children:"Copy and Modify Scenario"})]}),(0,l.jsxs)(x.S,{spacing:"large",children:[(0,l.jsx)(m.L,{title:"Scenario info",children:(0,l.jsx)(F,{modelDetail:D,regions:O})}),(0,l.jsx)(m.L,{title:"Run results",children:(0,l.jsx)(Z,{percentiles:D.results,reductionStartYear:D.reduction_start_year,reductionCompleteYear:D.reduction_end_year})}),(0,l.jsx)(m.L,{title:"BAU comparison",children:(0,l.jsx)(r.Z,{tabPosition:"top",centered:!0,activeKey:k,onChange:L,items:[{label:"Comparison Line Plot",key:"1",children:W},{label:"Difference Heatmap",key:"2",children:V}]})}),(0,l.jsx)(m.L,{title:"Crop loading details",children:D&&Y&&(0,l.jsx)(b.X,{customModelDetail:D,baseModelDetail:Y})}),(0,l.jsx)(m.L,{title:"Regions included in this scenario run",children:(0,l.jsx)("div",{id:"map",style:{height:"600px",margin:0},children:(0,l.jsx)(N,{data:O.map(e=>e.geometry)})})})]})]}))}},97333:function(e,t,n){"use strict";n.d(t,{B:function(){return i}});var l=n(57437),a=n(90471),r=n(47394);n(2265);let i=e=>{let{children:t,spacing:n,style:i}=e;return(0,l.jsx)(l.Fragment,{children:n?(0,l.jsx)(a.Z,{style:i,align:"center",size:n,children:t}):(0,l.jsx)(r.Z,{vertical:!1,justify:"space-between",style:i,align:"center",children:t})})}},54277:function(e,t,n){"use strict";n.d(t,{c:function(){return r}});var l=n(73208),a=n(2265);let r=()=>{let[e,t]=(0,a.useState)([]),[n,r]=(0,a.useState)([]),[i,o]=(0,a.useState)([]),[s,c]=(0,a.useState)([]),d=(e,t)=>{l.Z.get("http://localhost:8010/api/scenario/",{params:{scenario_type:e}}).then(e=>{t(e.data)}).catch(e=>{console.log(e)})};return(0,a.useEffect)(()=>{d(1,e=>t(e.results)),d(3,e=>r(e.results)),d(2,e=>o(e.results)),d(4,e=>c(e.results))},[]),{flowScenarios:e,loadScenarios:n,unsatScenarios:i,welltypeScenarios:s}}},1633:function(e,t,n){"use strict";n.d(t,{FP:function(){return l},L0:function(){return i},m7:function(){return r},yb:function(){return a}});let l={CENTRAL_VALLEY:0,SUB_BASIN:1,CVHM_FARM:2,B118_BASIN:3,COUNTY:4,TOWNSHIPS:5,C2V_SIM_SUBREGIONS:6},a={min:0,max:800,step:1,maxIdentifier:!0},r={min:0,max:800,step:1,maxIdentifier:!0},i=[{dataIndex:"name",title:"Scenario Name",width:150},{dataIndex:"flowScenario",title:"Flow Scenario",width:200},{dataIndex:"loadScenario",title:"Load Scenario",width:130},{dataIndex:"unsatScenario",title:"Unsat Scenario",width:150},{dataIndex:"wellTypeScenario",title:"Well Type Scenario",width:130},{dataIndex:"simEndYear",title:"Year Range",width:130},{dataIndex:"reductionStartYear",title:"Implementation Start Year",width:50},{dataIndex:"reductionEndYear",title:"Implementation Complete Year",width:50},{dataIndex:"waterContent",title:"Water Content",width:80},{dataIndex:"dateCreated",title:"Date Created",width:120}]}},function(e){e.O(0,[336,23,644,473,808,220,648,357,571,487,77,183,761,587,741,434,971,582,744],function(){return e(e.s=42499)}),_N_E=e.O()}]);